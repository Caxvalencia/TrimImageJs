!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r=e();for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}(window,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";var n;r.r(e),function(t){t.TOP="TOP",t.RIGHT="RIGHT",t.BOTTOM="BOTTOM",t.LEFT="LEFT"}(n||(n={}));var o,i=function(){function t(){}return t.create=function(t,e){var r=document.createElement("canvas");return r.width=t,r.height=e,r},t.context=function(e,r){return t.create(e,r).getContext("2d")},t}(),a=function(){function t(){}return t.getPixel=function(t){return function(e){return t[e]}},t}(),u=(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.apply=function(e,r,n){for(var o=t.getPixel.call(this,e),i=1,a=4,u=0;u<r;u+=i)for(var c=u*n,f=0;f<n;f+=a){if(0!==o(c+f+3))return{row:u,col:f}}},e}(a),f=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.apply=function(e,r,n){for(var o=-1,i=t.getPixel.call(this,e),a=n,u=r;u>=0;u--){o=u*a;for(var c=a;c>0;c-=4){if(0!==i(o-c-1))return{row:u,col:c}}}},e}(a),s=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.apply=function(e,r,n){for(var o=t.getPixel.call(this,e),i=r,a=n,u=0;u<a;u+=4)for(var c=0;c<i;c++){if(0!==o(c*a+u+3))return{row:c,col:u}}},e}(a),h=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.apply=function(e,r,n){for(var o=t.getPixel.call(this,e),i=r-1,a=n,u=a;u>0;u-=4)for(var c=i;c>1;c--){if(0!==o(c*a-4+u))return{row:c,col:u}}},e}(a),g=function(){function t(){}return t.getImage=function(e){t.validate(e);var r=e.width,n=e.height,o=i.create(r,n);o.getContext("2d").putImageData(e,0,0);var a=new Image;return a.width=r,a.height=n,a.src=o.toDataURL("image/png"),a},t.getImageData=function(t){var e=t.width,r=t.height,n=i.context(e,r);return n.drawImage(t,0,0,e,r),n.getImageData(0,0,e,r)},t.create=function(t,e){return i.context(t,e).createImageData(t,e)},t.validate=function(t){if("imagedata"!==(e=t,{}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()))throw"ImageData Exception: No es compatible el tipo de dato";var e},t.cutImageData=function(e,r,n,o,i){t.validate(e);var a=e.data,u=4*e.width;o=0==o?1:o,i=0==i?1:i;for(var c=o==r?1:o-r,f=i/4-n/4,p=t.create(f,c),s=u-i,l=0,h=r;h<o;h++)for(var m=h*i+h*s,g=n;g<i;g+=4,l+=4)p.data[l]=a[m+g],p.data[l+1]=a[m+g+1],p.data[l+2]=a[m+g+2],p.data[l+3]=a[m+g+3];return p},t.readImageData=function(e,r){t.validate(r);var o,i=r.data,a=r.height,u=4*r.width;return((o={})[n.TOP]=c,o[n.BOTTOM]=p,o[n.LEFT]=l,o[n.RIGHT]=m,o)[e].apply(i,a,u)},t}();var y=function(){function t(){}return t.create=function(t){return new Promise(function(e,r){var n=new Image;n.onload=function(){return e(n)},n.onerror=r,n.src=t})},t}(),d=function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}c((n=n.apply(t,e||[])).next())})},v=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},_=function(){function t(t,e){this.configureImage(t,e)}return t.trim=function(e,r){return new t(e,r).trim()},t.trimTop=function(e,r){return new t(e,r).trimTop()},t.trimBottom=function(e,r){return new t(e,r).trimBottom()},t.trimLeft=function(e,r){return new t(e,r).trimLeft()},t.trimRight=function(e,r){return new t(e,r).trimRight()},t.prototype.configureImage=function(t,e){return d(this,void 0,void 0,function(){var r,n;return v(this,function(o){switch(o.label){case 0:return r=this,"string"!=typeof t?[3,2]:[4,y.create(t)];case 1:return n=o.sent(),[3,3];case 2:n=t,o.label=3;case 3:return r.image=n,void 0!==e&&e.call(this,this.image),[2]}})})},t.prototype.trim=function(){return this.image=g.getImage(this._trim(g.getImageData(this.image))),this},t.prototype.trimTop=function(){return this.image=g.getImage(this._trimTop(g.getImageData(this.image))),this},t.prototype.trimBottom=function(){return this.image=g.getImage(this._trimBottom(g.getImageData(this.image))),this},t.prototype.trimLeft=function(){return this.image=g.getImage(this._trimLeft(g.getImageData(this.image))),this},t.prototype.trimRight=function(){return this.image=g.getImage(this._trimRight(g.getImageData(this.image))),this},t.prototype._trim=function(t){g.validate(t);var e=this._trimTop(t);return e=this._trimBottom(e),e=this._trimLeft(e),e=this._trimRight(e)},t.prototype._trimTop=function(t){var e=g.readImageData(n.TOP,t).row,r=4*t.width,o=t.height;return g.cutImageData(t,e,0,o,r)},t.prototype._trimBottom=function(t){var e=t.height,r=4*t.width;return e=g.readImageData(n.BOTTOM,t).row||e,g.cutImageData(t,0,0,e,r)},t.prototype._trimLeft=function(t){var e=g.readImageData(n.LEFT,t).col,r=4*t.width,o=t.height;return g.cutImageData(t,0,e,o,r)},t.prototype._trimRight=function(t){var e=4*t.width,r=t.height;return e=g.readImageData(n.RIGHT,t).col||e,g.cutImageData(t,0,0,r,e)},t}();r.d(e,"TrimImage",function(){return _})}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly8vLi9zcmMvY29uc3RhbnRzL3R5cGUtcmVhZGVyLnRzIiwid2VicGFjazovLy8uL3NyYy9oZWxwZXJzL2NhbnZhcy5oZWxwZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3JlYWRlcnMvcmVhZGVyLWJhc2UudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3JlYWRlcnMvcmVhZGVyLXRvcC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvcmVhZGVycy9yZWFkZXItYm90dG9tLnRzIiwid2VicGFjazovLy8uL3NyYy9yZWFkZXJzL3JlYWRlci1sZWZ0LnRzIiwid2VicGFjazovLy8uL3NyYy9yZWFkZXJzL3JlYWRlci1yaWdodC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvaGVscGVycy9pbWFnZS1kYXRhLmhlbHBlci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvaGVscGVycy9pbWFnZS5oZWxwZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3RyaW0taW1hZ2UudHMiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwiZGVmaW5lIiwiYW1kIiwiYSIsImkiLCJ3aW5kb3ciLCJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImNvbmZpZ3VyYWJsZSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwidmFsdWUiLCJuIiwiX19lc01vZHVsZSIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIlR5cGVSZWFkZXIiLCJDYW52YXNIZWxwZXIiLCJjcmVhdGUiLCJ3aWR0aCIsImhlaWdodCIsImNhbnZhcyIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImNvbnRleHQiLCJnZXRDb250ZXh0IiwiUmVhZGVyQmFzZSIsImdldFBpeGVsIiwicGl4ZWxzIiwiaW5kZXgiLCJyZWFkZXJfdG9wX1JlYWRlclRvcCIsIl9zdXBlciIsIlJlYWRlclRvcCIsInJlYWRlcl90b3BfZXh0ZW5kcyIsImFwcGx5IiwibGVuUm93IiwibGVuQ29sIiwidGhpcyIsImludGVyYXRvciIsInJvdyIsInJvd0N1cnJlbnQiLCJjb2wiLCJyZWFkZXJfYm90dG9tX1JlYWRlckJvdHRvbSIsIlJlYWRlckJvdHRvbSIsInJlYWRlcl9ib3R0b21fZXh0ZW5kcyIsImNvbEluaSIsInJlYWRlcl9sZWZ0X1JlYWRlckxlZnQiLCJSZWFkZXJMZWZ0IiwicmVhZGVyX2xlZnRfZXh0ZW5kcyIsInJvd0VuZCIsImNvbEVuZCIsInJlYWRlcl9yaWdodF9SZWFkZXJSaWdodCIsIlJlYWRlclJpZ2h0IiwicmVhZGVyX3JpZ2h0X2V4dGVuZHMiLCJyb3dJbmkiLCJpbWFnZV9kYXRhX2hlbHBlcl9JbWFnZURhdGFIZWxwZXIiLCJJbWFnZURhdGFIZWxwZXIiLCJnZXRJbWFnZSIsImltYWdlRGF0YSIsInZhbGlkYXRlIiwiaW1nV2lkdGgiLCJpbWdIZWlnaHQiLCJwdXRJbWFnZURhdGEiLCJpbWFnZSIsIkltYWdlIiwic3JjIiwidG9EYXRhVVJMIiwiZ2V0SW1hZ2VEYXRhIiwiZHJhd0ltYWdlIiwiY3JlYXRlSW1hZ2VEYXRhIiwiZWxlbWVudCIsInRvU3RyaW5nIiwibWF0Y2giLCJ0b0xvd2VyQ2FzZSIsImN1dEltYWdlRGF0YSIsInJvd0luaXQiLCJjb2xJbml0IiwiZGF0YSIsImNvcHlIZWlnaHQiLCJjb3B5V2lkdGgiLCJjb3B5SW1hZ2VEYXRhIiwiZGlmZkNvbCIsImNvdW50Q29weSIsInJlYWRJbWFnZURhdGEiLCJ0eXBlUmVhZGVyIiwiX2EiLCJUT1AiLCJCT1RUT00iLCJMRUZUIiwiUklHSFQiLCJJbWFnZUhlbHBlciIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiaW1nIiwib25sb2FkIiwib25lcnJvciIsInRyaW1faW1hZ2VfVHJpbUltYWdlIiwiVHJpbUltYWdlIiwiY2FsbGJhY2siLCJjb25maWd1cmVJbWFnZSIsInRyaW0iLCJ0cmltVG9wIiwidHJpbUJvdHRvbSIsInRyaW1MZWZ0IiwidHJpbVJpZ2h0IiwiX2IiLCJfYyIsInNlbnQiLCJ1bmRlZmluZWQiLCJfdHJpbSIsIl90cmltVG9wIiwiX3RyaW1Cb3R0b20iLCJfdHJpbUxlZnQiLCJfdHJpbVJpZ2h0IiwidHJpbW1lZEltYWdlIiwibGVuZ2h0Q29sIiwibGVuZ2h0Um93IiwiY29sdW1uIl0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFBQSxFQUFBQyxHQUNBLG9CQUFBQyxTQUFBLGlCQUFBQyxPQUNBQSxPQUFBRCxRQUFBRCxTQUNBLHNCQUFBRyxlQUFBQyxJQUNBRCxVQUFBSCxPQUNBLENBQ0EsSUFBQUssRUFBQUwsSUFDQSxRQUFBTSxLQUFBRCxHQUFBLGlCQUFBSixnQkFBQUYsR0FBQU8sR0FBQUQsRUFBQUMsSUFQQSxDQVNDQyxPQUFBLFdBQ0QsbUJDVEEsSUFBQUMsS0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQVQsUUFHQSxJQUFBQyxFQUFBTSxFQUFBRSxJQUNBSixFQUFBSSxFQUNBQyxHQUFBLEVBQ0FWLFlBVUEsT0FOQVcsRUFBQUYsR0FBQUcsS0FBQVgsRUFBQUQsUUFBQUMsSUFBQUQsUUFBQVEsR0FHQVAsRUFBQVMsR0FBQSxFQUdBVCxFQUFBRCxRQTJDQSxPQXRDQVEsRUFBQUssRUFBQUYsRUFHQUgsRUFBQU0sRUFBQVAsRUFHQUMsRUFBQU8sRUFBQSxTQUFBZixFQUFBZ0IsRUFBQUMsR0FDQVQsRUFBQVUsRUFBQWxCLEVBQUFnQixJQUNBRyxPQUFBQyxlQUFBcEIsRUFBQWdCLEdBQ0FLLGNBQUEsRUFDQUMsWUFBQSxFQUNBQyxJQUFBTixLQU1BVCxFQUFBZ0IsRUFBQSxTQUFBeEIs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RyxFQUFZM0QsRUFBVXRDLE9BRTFCLE9BQU9tQyxFQUFnQm1CLGFBQWFoQixFQUFXbkIsRUFBSyxFQUFHOEUsRUFBV0QsSUFROURsQixFQUFBdEYsVUFBQW9HLFlBQVIsU0FBb0J0RCxHQUNoQixJQUFJMkQsRUFBWTNELEVBQVV0QyxPQUN0QmdHLEVBQThCLEVBQWxCMUQsRUFBVXZDLE1BTTFCLE9BSkFrRyxFQUNJOUQsRUFBZ0I0QixjQUFjbkUsRUFBV3VFLE9BQVE3QixHQUFXbkIsS0FDNUQ4RSxFQUVHOUQsRUFBZ0JtQixhQUFhaEIsRUFBVyxFQUFHLEVBQUcyRCxFQUFXRCxJQVE1RGxCLEVBQUF0RixVQUFBcUcsVUFBUixTQUFrQnZELEdBQ2QsSUFBSTRELEVBQVMvRCxFQUFnQjRCLGNBQWNuRSxFQUFXd0UsS0FBTTlCLEdBQ3ZEakIsSUFDRDJFLEVBQThCLEVBQWxCMUQsRUFBVXZDLE1BQ3RCa0csRUFBWTNELEVBQVV0QyxPQUUxQixPQUFPbUMsRUFBZ0JtQixhQUFhaEIsRUFBVyxFQUFHNEQsRUFBUUQsRUFBV0QsSUFRakVsQixFQUFBdEYsVUFBQXNHLFdBQVIsU0FBbUJ4RCxHQUNmLElBQUl0QixFQUEyQixFQUFsQnNCLEVBQVV2QyxNQUNuQmdCLEVBQVN1QixFQUFVdEMsT0FNdkIsT0FKQWdCLEVBQ0ltQixFQUFnQjRCLGNBQWNuRSxFQUFXeUUsTUFBTy9CLEdBQVdqQixLQUMzREwsRUFFR21CLEVBQWdCbUIsYUFBYWhCLEVBQVcsRUFBRyxFQUFHdkIsRUFBUUMsSUFFckU4RCxFQXRMQSIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXSwgZmFjdG9yeSk7XG5cdGVsc2Uge1xuXHRcdHZhciBhID0gZmFjdG9yeSgpO1xuXHRcdGZvcih2YXIgaSBpbiBhKSAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnID8gZXhwb3J0cyA6IHJvb3QpW2ldID0gYVtpXTtcblx0fVxufSkod2luZG93LCBmdW5jdGlvbigpIHtcbnJldHVybiAiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbiBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbiBcdFx0XHR9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiZXhwb3J0IGVudW0gVHlwZVJlYWRlciB7XG4gICAgVE9QID0gJ1RPUCcsXG4gICAgUklHSFQgPSAnUklHSFQnLFxuICAgIEJPVFRPTSA9ICdCT1RUT00nLFxuICAgIExFRlQgPSAnTEVGVCdcbn1cbiIsImV4cG9ydCBhYnN0cmFjdCBjbGFzcyBDYW52YXNIZWxwZXIge1xuICAgIC8qKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gd2lkdGhcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaGVpZ2h0XG4gICAgICogQHJldHVybnMge0hUTUxDYW52YXNFbGVtZW50fVxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVhdGUod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpOiBIVE1MQ2FudmFzRWxlbWVudCB7XG4gICAgICAgIGxldCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICAgICAgY2FudmFzLndpZHRoID0gd2lkdGg7XG4gICAgICAgIGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICAgICAgcmV0dXJuIGNhbnZhcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHdpZHRoXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGhlaWdodFxuICAgICAqIEByZXR1cm5zIHtDYW52YXNSZW5kZXJpbmdDb250ZXh0MkR9XG4gICAgICovXG4gICAgc3RhdGljIGNvbnRleHQod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpOiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQge1xuICAgICAgICByZXR1cm4gQ2FudmFzSGVscGVyLmNyZWF0ZSh3aWR0aCwgaGVpZ2h0KS5nZXRDb250ZXh0KCcyZCcpO1xuICAgIH1cbn1cbiIsImV4cG9ydCBhYnN0cmFjdCBjbGFzcyBSZWFkZXJCYXNlIHtcbiAgICAvKipcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHBhcmFtIHtVaW50OENsYW1wZWRBcnJheX0gcGl4ZWxzXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufVxuICAgICAqL1xuICAgIHN0YXRpYyBnZXRQaXhlbChwaXhlbHM6IFVpbnQ4Q2xhbXBlZEFycmF5KTogRnVuY3Rpb24ge1xuICAgICAgICByZXR1cm4gKGluZGV4OiBudW1iZXIpOiBudW1iZXIgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHBpeGVsc1tpbmRleF07XG4gICAgICAgIH07XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSVJlYWRlclBvc2l0aW9uIH0gZnJvbSAnLi4vY29udHJhY3RzL3JlYWRlci1wb3NpdGlvbic7XG5pbXBvcnQgeyBSZWFkZXJCYXNlIH0gZnJvbSAnLi9yZWFkZXItYmFzZSc7XG5cbmV4cG9ydCBjbGFzcyBSZWFkZXJUb3AgZXh0ZW5kcyBSZWFkZXJCYXNlIHtcbiAgICAvKipcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHBhcmFtIHtVaW50OENsYW1wZWRBcnJheX0gcGl4ZWxzXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGxlblJvd1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBsZW5Db2xcbiAgICAgKiBAcmV0dXJucyB7SVJlYWRlclBvc2l0aW9ufVxuICAgICAqL1xuICAgIHN0YXRpYyBhcHBseShcbiAgICAgICAgcGl4ZWxzOiBVaW50OENsYW1wZWRBcnJheSxcbiAgICAgICAgbGVuUm93OiBudW1iZXIsXG4gICAgICAgIGxlbkNvbDogbnVtYmVyXG4gICAgKTogSVJlYWRlclBvc2l0aW9uIHtcbiAgICAgICAgbGV0IGdldFBpeGVsID0gc3VwZXIuZ2V0UGl4ZWwocGl4ZWxzKTtcbiAgICAgICAgbGV0IGludGVyYXRvciA9IHtcbiAgICAgICAgICAgIHJvdzogMSxcbiAgICAgICAgICAgIGNvbDogNFxuICAgICAgICB9O1xuXG4gICAgICAgIGZvciAobGV0IHJvdyA9IDA7IHJvdyA8IGxlblJvdzsgcm93ICs9IGludGVyYXRvci5yb3cpIHtcbiAgICAgICAgICAgIGxldCByb3dDdXJyZW50ID0gcm93ICogbGVuQ29sO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBjb2wgPSAwOyBjb2wgPCBsZW5Db2w7IGNvbCArPSBpbnRlcmF0b3IuY29sKSB7XG4gICAgICAgICAgICAgICAgbGV0IGFscGhhID0gZ2V0UGl4ZWwocm93Q3VycmVudCArIGNvbCArIDMpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGFscGhhID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB7IHJvdywgY29sIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBJUmVhZGVyUG9zaXRpb24gfSBmcm9tICcuLi9jb250cmFjdHMvcmVhZGVyLXBvc2l0aW9uJztcbmltcG9ydCB7IFJlYWRlckJhc2UgfSBmcm9tICcuL3JlYWRlci1iYXNlJztcblxuZXhwb3J0IGNsYXNzIFJlYWRlckJvdHRvbSBleHRlbmRzIFJlYWRlckJhc2Uge1xuICAgIC8qKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcGFyYW0ge1VpbnQ4Q2xhbXBlZEFycmF5fSBwaXhlbHNcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbGVuUm93XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGxlbkNvbFxuICAgICAqIEByZXR1cm5zIHtJUmVhZGVyUG9zaXRpb259XG4gICAgICovXG4gICAgc3RhdGljIGFwcGx5KFxuICAgICAgICBwaXhlbHM6IFVpbnQ4Q2xhbXBlZEFycmF5LFxuICAgICAgICBsZW5Sb3c6IG51bWJlcixcbiAgICAgICAgbGVuQ29sOiBudW1iZXJcbiAgICApOiBJUmVhZGVyUG9zaXRpb24ge1xuICAgICAgICBsZXQgcm93Q3VycmVudCA9IC0xO1xuICAgICAgICBsZXQgZ2V0UGl4ZWwgPSBzdXBlci5nZXRQaXhlbChwaXhlbHMpO1xuXG4gICAgICAgIGxldCByb3dJbmkgPSBsZW5Sb3c7XG4gICAgICAgIGxldCByb3dGaW4gPSAwO1xuICAgICAgICBsZXQgY29sSW5pID0gbGVuQ29sO1xuICAgICAgICBsZXQgY29sRmluID0gMDtcblxuICAgICAgICBmb3IgKGxldCByb3cgPSByb3dJbmk7IHJvdyA+PSByb3dGaW47IHJvdy0tKSB7XG4gICAgICAgICAgICByb3dDdXJyZW50ID0gcm93ICogY29sSW5pO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBjb2wgPSBjb2xJbmk7IGNvbCA+IGNvbEZpbjsgY29sIC09IDQpIHtcbiAgICAgICAgICAgICAgICBsZXQgYWxwaGEgPSBnZXRQaXhlbChyb3dDdXJyZW50IC0gY29sIC0gMSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoYWxwaGEgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgcm93LCBjb2wgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IElSZWFkZXJQb3NpdGlvbiB9IGZyb20gJy4uL2NvbnRyYWN0cy9yZWFkZXItcG9zaXRpb24nO1xuaW1wb3J0IHsgUmVhZGVyQmFzZSB9IGZyb20gJy4vcmVhZGVyLWJhc2UnO1xuXG5leHBvcnQgY2xhc3MgUmVhZGVyTGVmdCBleHRlbmRzIFJlYWRlckJhc2Uge1xuICAgIC8qKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcGFyYW0ge1VpbnQ4Q2xhbXBlZEFycmF5fSBwaXhlbHNcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbGVuUm93XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGxlbkNvbFxuICAgICAqIEByZXR1cm5zIHtJUmVhZGVyUG9zaXRpb259XG4gICAgICovXG4gICAgc3RhdGljIGFwcGx5KFxuICAgICAgICBwaXhlbHM6IFVpbnQ4Q2xhbXBlZEFycmF5LFxuICAgICAgICBsZW5Sb3c6IG51bWJlcixcbiAgICAgICAgbGVuQ29sOiBudW1iZXJcbiAgICApOiBJUmVhZGVyUG9zaXRpb24ge1xuICAgICAgICBsZXQgcm93Q3VycmVudCA9IC0xO1xuICAgICAgICBsZXQgZ2V0UGl4ZWwgPSBzdXBlci5nZXRQaXhlbChwaXhlbHMpO1xuXG4gICAgICAgIGxldCByb3dJbml0ID0gMDtcbiAgICAgICAgbGV0IHJvd0VuZCA9IGxlblJvdztcbiAgICAgICAgbGV0IGNvbEluaXQgPSAwO1xuICAgICAgICBsZXQgY29sRW5kID0gbGVuQ29sO1xuXG4gICAgICAgIGZvciAobGV0IGNvbCA9IGNvbEluaXQ7IGNvbCA8IGNvbEVuZDsgY29sICs9IDQpIHtcbiAgICAgICAgICAgIGZvciAobGV0IHJvdyA9IHJvd0luaXQ7IHJvdyA8IHJvd0VuZDsgcm93KyspIHtcbiAgICAgICAgICAgICAgICByb3dDdXJyZW50ID0gcm93ICogY29sRW5kO1xuXG4gICAgICAgICAgICAgICAgbGV0IGFscGhhID0gZ2V0UGl4ZWwocm93Q3VycmVudCArIGNvbCArIDMpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGFscGhhID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB7IHJvdywgY29sIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBJUmVhZGVyUG9zaXRpb24gfSBmcm9tICcuLi9jb250cmFjdHMvcmVhZGVyLXBvc2l0aW9uJztcbmltcG9ydCB7IFJlYWRlckJhc2UgfSBmcm9tICcuL3JlYWRlci1iYXNlJztcblxuZXhwb3J0IGNsYXNzIFJlYWRlclJpZ2h0IGV4dGVuZHMgUmVhZGVyQmFzZSB7XG4gICAgLyoqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBwYXJhbSB7VWludDhDbGFtcGVkQXJyYXl9IHBpeGVsc1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBsZW5Sb3dcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbGVuQ29sXG4gICAgICogQHJldHVybnMge0lSZWFkZXJQb3NpdGlvbn1cbiAgICAgKi9cbiAgICBzdGF0aWMgYXBwbHkoXG4gICAgICAgIHBpeGVsczogVWludDhDbGFtcGVkQXJyYXksXG4gICAgICAgIGxlblJvdzogbnVtYmVyLFxuICAgICAgICBsZW5Db2w6IG51bWJlclxuICAgICk6IElSZWFkZXJQb3NpdGlvbiB7XG4gICAgICAgIGxldCByb3dDdXJyZW50ID0gLTE7XG4gICAgICAgIGxldCBnZXRQaXhlbCA9IHN1cGVyLmdldFBpeGVsKHBpeGVscyk7XG5cbiAgICAgICAgbGV0IHJvd0luaSA9IGxlblJvdyAtIDE7XG4gICAgICAgIGxldCByb3dGaW4gPSAxO1xuICAgICAgICBsZXQgY29sSW5pID0gbGVuQ29sO1xuICAgICAgICBsZXQgY29sRmluID0gMDtcblxuICAgICAgICBmb3IgKGxldCBjb2wgPSBjb2xJbmk7IGNvbCA+IGNvbEZpbjsgY29sIC09IDQpIHtcbiAgICAgICAgICAgIGZvciAobGV0IHJvdyA9IHJvd0luaTsgcm93ID4gcm93RmluOyByb3ctLSkge1xuICAgICAgICAgICAgICAgIHJvd0N1cnJlbnQgPSByb3cgKiBjb2xJbmkgLSA0ICsgY29sO1xuXG4gICAgICAgICAgICAgICAgbGV0IGFscGhhID0gZ2V0UGl4ZWwocm93Q3VycmVudCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoYWxwaGEgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgcm93LCBjb2wgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IENhbnZhc0hlbHBlciB9IGZyb20gJy4vY2FudmFzLmhlbHBlcic7XG5pbXBvcnQgeyBUeXBlUmVhZGVyIH0gZnJvbSAnLi4vY29uc3RhbnRzL3R5cGUtcmVhZGVyJztcbmltcG9ydCB7IElSZWFkZXJQb3NpdGlvbiB9IGZyb20gJy4uL2NvbnRyYWN0cy9yZWFkZXItcG9zaXRpb24nO1xuaW1wb3J0IHsgUmVhZGVyVG9wIH0gZnJvbSAnLi4vcmVhZGVycy9yZWFkZXItdG9wJztcbmltcG9ydCB7IFJlYWRlckJvdHRvbSB9IGZyb20gJy4uL3JlYWRlcnMvcmVhZGVyLWJvdHRvbSc7XG5pbXBvcnQgeyBSZWFkZXJMZWZ0IH0gZnJvbSAnLi4vcmVhZGVycy9yZWFkZXItbGVmdCc7XG5pbXBvcnQgeyBSZWFkZXJSaWdodCB9IGZyb20gJy4uL3JlYWRlcnMvcmVhZGVyLXJpZ2h0JztcblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEltYWdlRGF0YUhlbHBlciB7XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIC0gQ29udmllcnRlIHVuIGltYWdlRGF0YSBvYmplY3QgYSB1biBpbWFnZSBvYmplY3RcbiAgICAgKiBAcGFyYW0ge0ltYWdlRGF0YX0gaW1hZ2VEYXRhIC0gT2JqZXRvIGNvbiBtYXRyaXogZGUgZGF0b3MgZGUgbGEgaW1hZ2VuXG4gICAgICogQHJldHVybiB7SFRNTEltYWdlRWxlbWVudH1cbiAgICAgKi9cbiAgICBzdGF0aWMgZ2V0SW1hZ2UoaW1hZ2VEYXRhOiBJbWFnZURhdGEpIHtcbiAgICAgICAgSW1hZ2VEYXRhSGVscGVyLnZhbGlkYXRlKGltYWdlRGF0YSk7XG5cbiAgICAgICAgbGV0IGltZ1dpZHRoID0gaW1hZ2VEYXRhLndpZHRoO1xuICAgICAgICBsZXQgaW1nSGVpZ2h0ID0gaW1hZ2VEYXRhLmhlaWdodDtcblxuICAgICAgICBsZXQgY2FudmFzID0gQ2FudmFzSGVscGVyLmNyZWF0ZShpbWdXaWR0aCwgaW1nSGVpZ2h0KTtcbiAgICAgICAgY2FudmFzLmdldENvbnRleHQoJzJkJykucHV0SW1hZ2VEYXRhKGltYWdlRGF0YSwgMCwgMCk7XG5cbiAgICAgICAgbGV0IGltYWdlID0gbmV3IEltYWdlKCk7XG4gICAgICAgIGltYWdlLndpZHRoID0gaW1nV2lkdGg7XG4gICAgICAgIGltYWdlLmhlaWdodCA9IGltZ0hlaWdodDtcbiAgICAgICAgaW1hZ2Uuc3JjID0gY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvcG5nJyk7XG5cbiAgICAgICAgcmV0dXJuIGltYWdlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcGFyYW0ge0hUTUxJbWFnZUVsZW1lbnR9IGltYWdlXG4gICAgICogQHJldHVybnMge0ltYWdlRGF0YX1cbiAgICAgKi9cbiAgICBzdGF0aWMgZ2V0SW1hZ2VEYXRhKGltYWdlOiBIVE1MSW1hZ2VFbGVtZW50KTogSW1hZ2VEYXRhIHtcbiAgICAgICAgbGV0IGltZ1dpZHRoID0gaW1hZ2Uud2lkdGg7XG4gICAgICAgIGxldCBpbWdIZWlnaHQgPSBpbWFnZS5oZWlnaHQ7XG5cbiAgICAgICAgbGV0IGNvbnRleHQgPSBDYW52YXNIZWxwZXIuY29udGV4dChpbWdXaWR0aCwgaW1nSGVpZ2h0KTtcbiAgICAgICAgY29udGV4dC5kcmF3SW1hZ2UoaW1hZ2UsIDAsIDAsIGltZ1dpZHRoLCBpbWdIZWlnaHQpO1xuXG4gICAgICAgIHJldHVybiBjb250ZXh0LmdldEltYWdlRGF0YSgwLCAwLCBpbWdXaWR0aCwgaW1nSGVpZ2h0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHdpZHRoXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGhlaWdodFxuICAgICAqIEByZXR1cm5zIHtJbWFnZURhdGF9XG4gICAgICovXG4gICAgc3RhdGljIGNyZWF0ZSh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcik6IEltYWdlRGF0YSB7XG4gICAgICAgIHJldHVybiBDYW52YXNIZWxwZXIuY29udGV4dCh3aWR0aCwgaGVpZ2h0KS5jcmVhdGVJbWFnZURhdGEoXG4gICAgICAgICAgICB3aWR0aCxcbiAgICAgICAgICAgIGhlaWdodFxuICAgICAgICApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcGFyYW0ge0ltYWdlRGF0YX0gaW1hZ2VEYXRhXG4gICAgICovXG4gICAgc3RhdGljIHZhbGlkYXRlKGltYWdlRGF0YTogSW1hZ2VEYXRhKSB7XG4gICAgICAgIGlmIChpcyhpbWFnZURhdGEpICE9PSAnaW1hZ2VkYXRhJykge1xuICAgICAgICAgICAgdGhyb3cgJ0ltYWdlRGF0YSBFeGNlcHRpb246IE5vIGVzIGNvbXBhdGlibGUgZWwgdGlwbyBkZSBkYXRvJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7SW1hZ2VEYXRhfSBpbWFnZURhdGFcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcm93SW5pdFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjb2xJbml0XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHJvd0VuZFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjb2xFbmRcbiAgICAgKiBAcmV0dXJucyB7SW1hZ2VEYXRhfVxuICAgICAqL1xuICAgIHN0YXRpYyBjdXRJbWFnZURhdGEoXG4gICAgICAgIGltYWdlRGF0YTogSW1hZ2VEYXRhLFxuICAgICAgICByb3dJbml0OiBudW1iZXIsXG4gICAgICAgIGNvbEluaXQ6IG51bWJlcixcbiAgICAgICAgcm93RW5kOiBudW1iZXIsXG4gICAgICAgIGNvbEVuZDogbnVtYmVyXG4gICAgKTogSW1hZ2VEYXRhIHtcbiAgICAgICAgSW1hZ2VEYXRhSGVscGVyLnZhbGlkYXRlKGltYWdlRGF0YSk7XG5cbiAgICAgICAgbGV0IHBpeGVscyA9IGltYWdlRGF0YS5kYXRhO1xuICAgICAgICBsZXQgbGVuQ29sID0gaW1hZ2VEYXRhLndpZHRoICogNDtcblxuICAgICAgICByb3dFbmQgPSByb3dFbmQgPT0gMCA/IDEgOiByb3dFbmQ7XG4gICAgICAgIGNvbEVuZCA9IGNvbEVuZCA9PSAwID8gMSA6IGNvbEVuZDtcblxuICAgICAgICBsZXQgY29weUhlaWdodCA9IHJvd0VuZCA9PSByb3dJbml0ID8gMSA6IHJvd0VuZCAtIHJvd0luaXQ7XG4gICAgICAgIGxldCBjb3B5V2lkdGggPSBjb2xFbmQgLyA0IC0gY29sSW5pdCAvIDQ7XG5cbiAgICAgICAgbGV0IGNvcHlJbWFnZURhdGE6IEltYWdlRGF0YSA9IEltYWdlRGF0YUhlbHBlci5jcmVhdGUoXG4gICAgICAgICAgICBjb3B5V2lkdGgsXG4gICAgICAgICAgICBjb3B5SGVpZ2h0XG4gICAgICAgICk7XG5cbiAgICAgICAgbGV0IGRpZmZDb2wgPSBsZW5Db2wgLSBjb2xFbmQ7XG4gICAgICAgIGxldCBjb3VudENvcHkgPSAwO1xuXG4gICAgICAgIGZvciAobGV0IHJvdyA9IHJvd0luaXQ7IHJvdyA8IHJvd0VuZDsgcm93KyspIHtcbiAgICAgICAgICAgIGxldCByb3dDdXJyZW50ID0gcm93ICogY29sRW5kICsgcm93ICogZGlmZkNvbDtcblxuICAgICAgICAgICAgZm9yIChsZXQgY29sID0gY29sSW5pdDsgY29sIDwgY29sRW5kOyBjb2wgKz0gNCwgY291bnRDb3B5ICs9IDQpIHtcbiAgICAgICAgICAgICAgICBjb3B5SW1hZ2VEYXRhLmRhdGFbY291bnRDb3B5XSA9IHBpeGVsc1tyb3dDdXJyZW50ICsgY29sXTtcbiAgICAgICAgICAgICAgICBjb3B5SW1hZ2VEYXRhLmRhdGFbY291bnRDb3B5ICsgMV0gPVxuICAgICAgICAgICAgICAgICAgICBwaXhlbHNbcm93Q3VycmVudCArIGNvbCArIDFdO1xuICAgICAgICAgICAgICAgIGNvcHlJbWFnZURhdGEuZGF0YVtjb3VudENvcHkgKyAyXSA9XG4gICAgICAgICAgICAgICAgICAgIHBpeGVsc1tyb3dDdXJyZW50ICsgY29sICsgMl07XG4gICAgICAgICAgICAgICAgY29weUltYWdlRGF0YS5kYXRhW2NvdW50Q29weSArIDNdID1cbiAgICAgICAgICAgICAgICAgICAgcGl4ZWxzW3Jvd0N1cnJlbnQgKyBjb2wgKyAzXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjb3B5SW1hZ2VEYXRhO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtUeXBlUmVhZGVyfSB0eXBlUmVhZGVyXG4gICAgICogQHBhcmFtIHtJbWFnZURhdGF9IGltYWdlRGF0YVxuICAgICAqIEByZXR1cm5zIHtJbWFnZURhdGF9XG4gICAgICovXG4gICAgc3RhdGljIHJlYWRJbWFnZURhdGEoXG4gICAgICAgIHR5cGVSZWFkZXI6IFR5cGVSZWFkZXIsXG4gICAgICAgIGltYWdlRGF0YTogSW1hZ2VEYXRhXG4gICAgKTogSVJlYWRlclBvc2l0aW9uIHtcbiAgICAgICAgSW1hZ2VEYXRhSGVscGVyLnZhbGlkYXRlKGltYWdlRGF0YSk7XG5cbiAgICAgICAgbGV0IHBpeGVscyA9IGltYWdlRGF0YS5kYXRhO1xuICAgICAgICBsZXQgbGVuUm93ID0gaW1hZ2VEYXRhLmhlaWdodDtcbiAgICAgICAgbGV0IGxlbkNvbCA9IGltYWdlRGF0YS53aWR0aCAqIDQ7XG5cbiAgICAgICAgbGV0IHJlYWRlciA9IHtcbiAgICAgICAgICAgIFtUeXBlUmVhZGVyLlRPUF06IFJlYWRlclRvcCxcbiAgICAgICAgICAgIFtUeXBlUmVhZGVyLkJPVFRPTV06IFJlYWRlckJvdHRvbSxcbiAgICAgICAgICAgIFtUeXBlUmVhZGVyLkxFRlRdOiBSZWFkZXJMZWZ0LFxuICAgICAgICAgICAgW1R5cGVSZWFkZXIuUklHSFRdOiBSZWFkZXJSaWdodFxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiByZWFkZXJbdHlwZVJlYWRlcl0uYXBwbHkocGl4ZWxzLCBsZW5Sb3csIGxlbkNvbCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBpcyhlbGVtZW50KSB7XG4gICAgcmV0dXJuIHt9LnRvU3RyaW5nXG4gICAgICAgIC5jYWxsKGVsZW1lbnQpXG4gICAgICAgIC5tYXRjaCgvXFxzKFthLXp8QS1aXSspLylbMV1cbiAgICAgICAgLnRvTG93ZXJDYXNlKCk7XG59XG4iLCJleHBvcnQgYWJzdHJhY3QgY2xhc3MgSW1hZ2VIZWxwZXIge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzcmNcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxIVE1MSW1hZ2VFbGVtZW50Pn1cbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlYXRlKHNyYzogc3RyaW5nKTogUHJvbWlzZTxIVE1MSW1hZ2VFbGVtZW50PiB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICBsZXQgaW1nID0gbmV3IEltYWdlKCk7XG4gICAgICAgICAgICBpbWcub25sb2FkID0gKCkgPT4gcmVzb2x2ZShpbWcpO1xuICAgICAgICAgICAgaW1nLm9uZXJyb3IgPSByZWplY3Q7XG4gICAgICAgICAgICBpbWcuc3JjID0gc3JjO1xuICAgICAgICB9KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBUeXBlUmVhZGVyIH0gZnJvbSAnLi9jb25zdGFudHMvdHlwZS1yZWFkZXInO1xuaW1wb3J0IHsgSW1hZ2VEYXRhSGVscGVyIH0gZnJvbSAnLi9oZWxwZXJzL2ltYWdlLWRhdGEuaGVscGVyJztcbmltcG9ydCB7IEltYWdlSGVscGVyIH0gZnJvbSAnLi9oZWxwZXJzL2ltYWdlLmhlbHBlcic7XG5cbi8qKlxuICogQGV4cG9ydFxuICogQGNsYXNzIFRyaW1JbWFnZVxuICovXG5leHBvcnQgY2xhc3MgVHJpbUltYWdlIHtcbiAgICBwcml2YXRlIGltYWdlOiBIVE1MSW1hZ2VFbGVtZW50O1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBUcmltSW1hZ2UuXG4gICAgICogQHBhcmFtIHtIVE1MSW1hZ2VFbGVtZW50fSBpbWFnZVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoaW1hZ2U6IEhUTUxJbWFnZUVsZW1lbnQsIGNhbGxiYWNrOiBGdW5jdGlvbikge1xuICAgICAgICB0aGlzLmNvbmZpZ3VyZUltYWdlKGltYWdlLCBjYWxsYmFjayk7XG4gICAgfVxuXG4gICAgc3RhdGljIHRyaW0oaW1hZ2U/LCBjYWxsYmFjaz8pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUcmltSW1hZ2UoaW1hZ2UsIGNhbGxiYWNrKS50cmltKCk7XG4gICAgfVxuXG4gICAgc3RhdGljIHRyaW1Ub3AoaW1hZ2U/LCBjYWxsYmFjaz8pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUcmltSW1hZ2UoaW1hZ2UsIGNhbGxiYWNrKS50cmltVG9wKCk7XG4gICAgfVxuXG4gICAgc3RhdGljIHRyaW1Cb3R0b20oaW1hZ2U/LCBjYWxsYmFjaz8pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUcmltSW1hZ2UoaW1hZ2UsIGNhbGxiYWNrKS50cmltQm90dG9tKCk7XG4gICAgfVxuXG4gICAgc3RhdGljIHRyaW1MZWZ0KGltYWdlPywgY2FsbGJhY2s/KSB7XG4gICAgICAgIHJldHVybiBuZXcgVHJpbUltYWdlKGltYWdlLCBjYWxsYmFjaykudHJpbUxlZnQoKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgdHJpbVJpZ2h0KGltYWdlPywgY2FsbGJhY2s/KSB7XG4gICAgICAgIHJldHVybiBuZXcgVHJpbUltYWdlKGltYWdlLCBjYWxsYmFjaykudHJpbVJpZ2h0KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIC0gQ29uZmlndXJhIGVsIHBhcmFtZXRybyBkZSBlbnRyYWRhIFwiaW1hZ2VcIiBkZWwgY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0geyhzdHJpbmcgfCBIVE1MSW1hZ2VFbGVtZW50KX0gaW1hZ2VcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja1xuICAgICAqL1xuICAgIGFzeW5jIGNvbmZpZ3VyZUltYWdlKGltYWdlOiBzdHJpbmcgfCBIVE1MSW1hZ2VFbGVtZW50LCBjYWxsYmFjazogRnVuY3Rpb24pIHtcbiAgICAgICAgdGhpcy5pbWFnZSA9XG4gICAgICAgICAgICB0eXBlb2YgaW1hZ2UgPT09ICdzdHJpbmcnXG4gICAgICAgICAgICAgICAgPyBhd2FpdCBJbWFnZUhlbHBlci5jcmVhdGUoaW1hZ2UpXG4gICAgICAgICAgICAgICAgOiA8SFRNTEltYWdlRWxlbWVudD5pbWFnZTtcblxuICAgICAgICBpZiAoY2FsbGJhY2sgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY2FsbGJhY2suY2FsbCh0aGlzLCB0aGlzLmltYWdlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBkZXNjcmlwdGlvbiAtIEVsaW1pbmEgcGl4ZWxlcyBpbm5lY2VzYXJpb3MgcGFyYSB0b2RvcyBsb3MgYm9yZGVzIGRlIGxhIGltYWdlblxuICAgICAqL1xuICAgIHRyaW0oKSB7XG4gICAgICAgIHRoaXMuaW1hZ2UgPSBJbWFnZURhdGFIZWxwZXIuZ2V0SW1hZ2UoXG4gICAgICAgICAgICB0aGlzLl90cmltKEltYWdlRGF0YUhlbHBlci5nZXRJbWFnZURhdGEodGhpcy5pbWFnZSkpXG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIC0gRWxpbWluYSBwaXhlbGVzIGlubmVjZXNhcmlvcyBwYXJhIGVsIGJvcmRlIHN1cGVyaW9yIGRlIGxhIGltYWdlblxuICAgICAqIEByZXR1cm5zIHt0aGlzfVxuICAgICAqL1xuICAgIHRyaW1Ub3AoKTogdGhpcyB7XG4gICAgICAgIHRoaXMuaW1hZ2UgPSBJbWFnZURhdGFIZWxwZXIuZ2V0SW1hZ2UoXG4gICAgICAgICAgICB0aGlzLl90cmltVG9wKEltYWdlRGF0YUhlbHBlci5nZXRJbWFnZURhdGEodGhpcy5pbWFnZSkpXG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIC0gRWxpbWluYSBwaXhlbGVzIGlubmVjZXNhcmlvcyBwYXJhIGVsIGJvcmRlIGluZmVyaW9yIGRlIGxhIGltYWdlblxuICAgICAqIEByZXR1cm5zIHt0aGlzfVxuICAgICAqL1xuICAgIHRyaW1Cb3R0b20oKSB7XG4gICAgICAgIHRoaXMuaW1hZ2UgPSBJbWFnZURhdGFIZWxwZXIuZ2V0SW1hZ2UoXG4gICAgICAgICAgICB0aGlzLl90cmltQm90dG9tKEltYWdlRGF0YUhlbHBlci5nZXRJbWFnZURhdGEodGhpcy5pbWFnZSkpXG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIC0gRWxpbWluYSBwaXhlbGVzIGlubmVjZXNhcmlvcyBwYXJhIGVsIGJvcmRlIGl6cXVpZXJkbyBkZSBsYSBpbWFnZW5cbiAgICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICAgKi9cbiAgICB0cmltTGVmdCgpIHtcbiAgICAgICAgdGhpcy5pbWFnZSA9IEltYWdlRGF0YUhlbHBlci5nZXRJbWFnZShcbiAgICAgICAgICAgIHRoaXMuX3RyaW1MZWZ0KEltYWdlRGF0YUhlbHBlci5nZXRJbWFnZURhdGEodGhpcy5pbWFnZSkpXG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIC0gRWxpbWluYSBwaXhlbGVzIGlubmVjZXNhcmlvcyBwYXJhIGVsIGJvcmRlIGRlcmVjaG8gZGUgbGEgaW1hZ2VuXG4gICAgICogQHJldHVybnMge3RoaXN9XG4gICAgICovXG4gICAgdHJpbVJpZ2h0KCk6IHRoaXMge1xuICAgICAgICB0aGlzLmltYWdlID0gSW1hZ2VEYXRhSGVscGVyLmdldEltYWdlKFxuICAgICAgICAgICAgdGhpcy5fdHJpbVJpZ2h0KEltYWdlRGF0YUhlbHBlci5nZXRJbWFnZURhdGEodGhpcy5pbWFnZSkpXG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIC0gRWxpbWluYSBwaXhlbGVzIGRlIGxhIGltYWdlbiBpbm5lY2VzYXJpb3NcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7SW1hZ2VEYXRhfSBpbWFnZURhdGFcbiAgICAgKiBAcmV0dXJucyB7SW1hZ2VEYXRhfVxuICAgICAqL1xuICAgIHByaXZhdGUgX3RyaW0oaW1hZ2VEYXRhOiBJbWFnZURhdGEpOiBJbWFnZURhdGEge1xuICAgICAgICBJbWFnZURhdGFIZWxwZXIudmFsaWRhdGUoaW1hZ2VEYXRhKTtcblxuICAgICAgICBsZXQgdHJpbW1lZEltYWdlID0gdGhpcy5fdHJpbVRvcChpbWFnZURhdGEpO1xuICAgICAgICB0cmltbWVkSW1hZ2UgPSB0aGlzLl90cmltQm90dG9tKHRyaW1tZWRJbWFnZSk7XG4gICAgICAgIHRyaW1tZWRJbWFnZSA9IHRoaXMuX3RyaW1MZWZ0KHRyaW1tZWRJbWFnZSk7XG4gICAgICAgIHRyaW1tZWRJbWFnZSA9IHRoaXMuX3RyaW1SaWdodCh0cmltbWVkSW1hZ2UpO1xuXG4gICAgICAgIHJldHVybiB0cmltbWVkSW1hZ2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0ltYWdlRGF0YX0gaW1hZ2VEYXRhXG4gICAgICogQHJldHVybnMge0ltYWdlRGF0YX1cbiAgICAgKi9cbiAgICBwcml2YXRlIF90cmltVG9wKGltYWdlRGF0YTogSW1hZ2VEYXRhKTogSW1hZ2VEYXRhIHtcbiAgICAgICAgbGV0IHJvdyA9IEltYWdlRGF0YUhlbHBlci5yZWFkSW1hZ2VEYXRhKFR5cGVSZWFkZXIuVE9QLCBpbWFnZURhdGEpLnJvdzsgLy8gZGVmYXVsdCAwXG4gICAgICAgIGxldCBsZW5naHRDb2wgPSBpbWFnZURhdGEud2lkdGggKiA0O1xuICAgICAgICBsZXQgbGVuZ2h0Um93ID0gaW1hZ2VEYXRhLmhlaWdodDtcblxuICAgICAgICByZXR1cm4gSW1hZ2VEYXRhSGVscGVyLmN1dEltYWdlRGF0YShpbWFnZURhdGEsIHJvdywgMCwgbGVuZ2h0Um93LCBsZW5naHRDb2wpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtJbWFnZURhdGF9IGltYWdlRGF0YVxuICAgICAqIEByZXR1cm5zIHtJbWFnZURhdGF9XG4gICAgICovXG4gICAgcHJpdmF0ZSBfdHJpbUJvdHRvbShpbWFnZURhdGE6IEltYWdlRGF0YSk6IEltYWdlRGF0YSB7XG4gICAgICAgIGxldCBsZW5naHRSb3cgPSBpbWFnZURhdGEuaGVpZ2h0O1xuICAgICAgICBsZXQgbGVuZ2h0Q29sID0gaW1hZ2VEYXRhLndpZHRoICogNDtcblxuICAgICAgICBsZW5naHRSb3cgPVxuICAgICAgICAgICAgSW1hZ2VEYXRhSGVscGVyLnJlYWRJbWFnZURhdGEoVHlwZVJlYWRlci5CT1RUT00sIGltYWdlRGF0YSkucm93IHx8XG4gICAgICAgICAgICBsZW5naHRSb3c7XG5cbiAgICAgICAgcmV0dXJuIEltYWdlRGF0YUhlbHBlci5jdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCAwLCAwLCBsZW5naHRSb3csIGxlbmdodENvbCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0ltYWdlRGF0YX0gaW1hZ2VEYXRhXG4gICAgICogQHJldHVybnMge0ltYWdlRGF0YX1cbiAgICAgKi9cbiAgICBwcml2YXRlIF90cmltTGVmdChpbWFnZURhdGE6IEltYWdlRGF0YSk6IEltYWdlRGF0YSB7XG4gICAgICAgIGxldCBjb2x1bW4gPSBJbWFnZURhdGFIZWxwZXIucmVhZEltYWdlRGF0YShUeXBlUmVhZGVyLkxFRlQsIGltYWdlRGF0YSlcbiAgICAgICAgICAgIC5jb2w7IC8vZGVmYXVsdCAwXG4gICAgICAgIGxldCBsZW5naHRDb2wgPSBpbWFnZURhdGEud2lkdGggKiA0O1xuICAgICAgICBsZXQgbGVuZ2h0Um93ID0gaW1hZ2VEYXRhLmhlaWdodDtcblxuICAgICAgICByZXR1cm4gSW1hZ2VEYXRhSGVscGVyLmN1dEltYWdlRGF0YShpbWFnZURhdGEsIDAsIGNvbHVtbiwgbGVuZ2h0Um93LCBsZW5naHRDb2wpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtJbWFnZURhdGF9IGltYWdlRGF0YVxuICAgICAqIEByZXR1cm5zIHtJbWFnZURhdGF9XG4gICAgICovXG4gICAgcHJpdmF0ZSBfdHJpbVJpZ2h0KGltYWdlRGF0YTogSW1hZ2VEYXRhKTogSW1hZ2VEYXRhIHtcbiAgICAgICAgbGV0IGxlbkNvbCA9IGltYWdlRGF0YS53aWR0aCAqIDQ7XG4gICAgICAgIGxldCBsZW5Sb3cgPSBpbWFnZURhdGEuaGVpZ2h0O1xuXG4gICAgICAgIGxlbkNvbCA9XG4gICAgICAgICAgICBJbWFnZURhdGFIZWxwZXIucmVhZEltYWdlRGF0YShUeXBlUmVhZGVyLlJJR0hULCBpbWFnZURhdGEpLmNvbCB8fFxuICAgICAgICAgICAgbGVuQ29sO1xuXG4gICAgICAgIHJldHVybiBJbWFnZURhdGFIZWxwZXIuY3V0SW1hZ2VEYXRhKGltYWdlRGF0YSwgMCwgMCwgbGVuUm93LCBsZW5Db2wpO1xuICAgIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=