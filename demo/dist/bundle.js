!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r=e();for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}(window,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";var n;r.r(e),function(t){t.TOP="TOP",t.RIGHT="RIGHT",t.BOTTOM="BOTTOM",t.LEFT="LEFT"}(n||(n={}));var a=function(){function t(){}return t.create=function(t,e){var r=document.createElement("canvas");return r.width=t,r.height=e,r},t.context=function(e,r){return t.create(e,r).getContext("2d")},t}(),i=function(){function t(){}return t.getImage=function(e){t.validate(e);var r=e.width,n=e.height,i=a.create(r,n);i.getContext("2d").putImageData(e,0,0);var o=new Image;return o.width=r,o.height=n,o.src=i.toDataURL("image/png"),o},t.getImageData=function(t){var e=t.width,r=t.height,n=a.context(e,r);return n.drawImage(t,0,0,e,r),n.getImageData(0,0,e,r)},t.create=function(t,e){return a.context(t,e).createImageData(t,e)},t.validate=function(t){if("imagedata"!==(e=t,{}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()))throw"ImageData Exception: No es compatible el tipo de dato";var e},t}();var o=function(){function t(){}return t.create=function(t){return new Promise(function(e,r){var n=new Image;n.onload=function(){return e(n)},n.onerror=r,n.src=t})},t}(),u=function(t,e,r,n){return new(r||(r=Promise))(function(a,i){function o(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){t.done?a(t.value):new r(function(e){e(t.value)}).then(o,u)}c((n=n.apply(t,e||[])).next())})},c=function(t,e){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[0,a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},f=function(){function t(t,e){this.configureImage(t,e)}return t.prototype.configureImage=function(t,e){return u(this,void 0,void 0,function(){var r,n;return c(this,function(a){switch(a.label){case 0:return r=this,"string"!=typeof t?[3,2]:[4,o.create(t)];case 1:return n=a.sent(),[3,3];case 2:n=t,a.label=3;case 3:return r.image=n,void 0!==e&&e.call(this,this.image),[2]}})})},t.trim=function(e,r){return new t(e,r).trim()},t.trimTop=function(e,r){return new t(e,r).trimTop()},t.trimBottom=function(e,r){return new t(e,r).trimBottom()},t.trimLeft=function(e,r){return new t(e,r).trimLeft()},t.trimRight=function(e,r){return new t(e,r).trimRight()},t.prototype.trim=function(){return this.image=i.getImage(this._trim(i.getImageData(this.image))),this},t.prototype.trimTop=function(){return this.image=i.getImage(this._trimTop(i.getImageData(this.image))),this},t.prototype.trimBottom=function(){return this.image=i.getImage(this._trimBottom(i.getImageData(this.image))),this},t.prototype.trimLeft=function(){return this.image=i.getImage(this._trimLeft(i.getImageData(this.image))),this},t.prototype.trimRight=function(){return this.image=i.getImage(this._trimRight(i.getImageData(this.image))),this},t.prototype._trim=function(t){i.validate(t);var e=this._trimTop(t);return e=this._trimBottom(e),e=this._trimLeft(e),e=this._trimRight(e)},t.prototype._trimTop=function(t){var e=0,r=4*t.width,a=t.height;return this.readImageData(n.TOP,t,function(t,r,n){if(0!=n.alpha())return e=t,"break"}),this.cutImageData(t,e,0,a,r)},t.prototype._trimBottom=function(t){var e=t.height,r=4*t.width;return this.readImageData(n.BOTTOM,t,function(t,r,n){if(0!=n.alpha())return e=t,"break"}),this.cutImageData(t,0,0,e,r)},t.prototype._trimLeft=function(t){var e=0,r=4*t.width,a=t.height;return this.readImageData(n.LEFT,t,function(t,r,n){if(0!=n.alpha())return e=r,"break"}),this.cutImageData(t,0,e,a,r)},t.prototype._trimRight=function(t){var e=4*t.width,r=t.height;return this.readImageData(n.RIGHT,t,function(t,r,n){if(0!=n.alpha())return e=r,"break"}),this.cutImageData(t,0,0,r,e)},t.prototype.cutImageData=function(t,e,r,n,a){i.validate(t);var o=t.data,u=4*t.width;n=0==n?1:n,a=0==a?1:a;for(var c=n==e?1:n-e,f=a/4-r/4,h=i.create(f,c),m=u-a,s=0,g=e;g<n;g++)for(var p=g*a+g*m,l=r;l<a;l+=4,s+=4)h.data[s]=o[p+l],h.data[s+1]=o[p+l+1],h.data[s+2]=o[p+l+2],h.data[s+3]=o[p+l+3];return h},t.prototype.readImageData=function(t,e,r){i.validate(e);var a,o,u=e.data,c=-1,f=4*e.width,h=e.height,m=!1;if(t===n.TOP){var s=h,g=0,p=f,l={row:1,col:4};for(a=d=0;a<s;a+=l.row){for(c=a*f,o=g;o<p&&"break"!=(m=r.apply(this,[a,o,{red:b(c+o),green:b(c+o+1),blue:b(c+o+2),alpha:b(c+o+3)}]));o+=l.col);if("break"==m)break}}else if(t===n.BOTTOM){s=0,g=f,p=0;for(a=d=h;a>=s;a--){for(c=a*g,o=g;o>p&&"break"!=(m=r.apply(this,[a,o,{red:b(c-o),green:b(c-o-3),blue:b(c-o-2),alpha:b(c-o-1)}]));o-=4);if("break"==m)break}}else if(t===n.LEFT){var d=0;s=h,p=f;for(o=g=0;o<p;o+=4){for(a=d;a<s&&(c=a*p,"break"!=(m=r.apply(this,[a,o,{red:b(c+o),green:b(c+o+1),blue:b(c+o+2),alpha:b(c+o+3)}])));a++);if("break"==m)break}}else if(t===n.RIGHT){d=h-1,s=1,p=0;for(o=g=f;o>p;o-=4){for(a=d;a>s&&(c=a*g-4+o,"break"!=(m=r.apply(this,[a,o,{red:b(c-3),green:b(c-2),blue:b(c-1),alpha:b(c)}])));a--);if("break"==m)break}}function b(t){return function(e){if(!e)return u[t];u[t]=e}}return e},t}();r.d(e,"TrimImage",function(){return f})}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly8vLi9zcmMvY29uc3RhbnRzL3R5cGUtcmVhZGVyLnRzIiwid2VicGFjazovLy8uL3NyYy9oZWxwZXJzL2NhbnZhcy5oZWxwZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2hlbHBlcnMvaW1hZ2UtZGF0YS5oZWxwZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2hlbHBlcnMvaW1hZ2UuaGVscGVyLnRzIiwid2VicGFjazovLy8uL3NyYy90cmltLWltYWdlLnRzIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZSIsImRlZmluZSIsImFtZCIsImEiLCJpIiwid2luZG93IiwiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsInZhbHVlIiwibiIsIl9fZXNNb2R1bGUiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJUeXBlUmVhZGVyIiwiQ2FudmFzSGVscGVyIiwiY3JlYXRlIiwid2lkdGgiLCJoZWlnaHQiLCJjYW52YXMiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjb250ZXh0IiwiZ2V0Q29udGV4dCIsImltYWdlX2RhdGFfaGVscGVyX0ltYWdlRGF0YUhlbHBlciIsIkltYWdlRGF0YUhlbHBlciIsImdldEltYWdlIiwiaW1hZ2VEYXRhIiwidmFsaWRhdGUiLCJpbWdXaWR0aCIsImltZ0hlaWdodCIsInB1dEltYWdlRGF0YSIsImltYWdlIiwiSW1hZ2UiLCJzcmMiLCJ0b0RhdGFVUkwiLCJnZXRJbWFnZURhdGEiLCJkcmF3SW1hZ2UiLCJjcmVhdGVJbWFnZURhdGEiLCJlbGVtZW50IiwidG9TdHJpbmciLCJtYXRjaCIsInRvTG93ZXJDYXNlIiwiSW1hZ2VIZWxwZXIiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImltZyIsIm9ubG9hZCIsIm9uZXJyb3IiLCJ0cmltX2ltYWdlX1RyaW1JbWFnZSIsIlRyaW1JbWFnZSIsImZ1bmNMb2FkQmFjayIsInRoaXMiLCJjb25maWd1cmVJbWFnZSIsImNhbGxiYWNrIiwiX2EiLCJfYiIsIl9jIiwic2VudCIsInVuZGVmaW5lZCIsInRyaW0iLCJ0cmltVG9wIiwidHJpbUJvdHRvbSIsInRyaW1MZWZ0IiwidHJpbVJpZ2h0IiwiX3RyaW0iLCJfdHJpbVRvcCIsIl90cmltQm90dG9tIiwiX3RyaW1MZWZ0IiwiX3RyaW1SaWdodCIsInRyaW1tZWRJbWFnZSIsInJvdyIsImxlbmdodENvbCIsImxlbmdodFJvdyIsInJlYWRJbWFnZURhdGEiLCJUT1AiLCJfcm93IiwiX2NvbCIsInJnYmEiLCJhbHBoYSIsImN1dEltYWdlRGF0YSIsIkJPVFRPTSIsImNvbHVtbiIsIkxFRlQiLCJsZW5fY29sIiwibGVuX3JvdyIsIlJJR0hUIiwicm93SW5pIiwiY29sSW5pIiwicm93RmluIiwiY29sRmluIiwicGl4ZWxzIiwiZGF0YSIsImNvcHlIZWlnaHQiLCJjb3B5V2lkdGgiLCJjb3B5SW1hZ2VEYXRhIiwiZGlmZkNvbCIsImNvdW50Q29weSIsInJvd0N1cnJlbnQiLCJjb2wiLCJ0eXBlUmVhZGVyIiwiZnVuY0JhY2siLCJpc0JyZWFrIiwiaW50ZXJhdG9yIiwiYXBwbHkiLCJyZWQiLCJnZXRBbmRTZXRGb3JQaXhlbCIsImdyZWVuIiwiYmx1ZSIsInBvcyIsInZhbCJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsRUFBQUMsR0FDQSxvQkFBQUMsU0FBQSxpQkFBQUMsT0FDQUEsT0FBQUQsUUFBQUQsU0FDQSxzQkFBQUcsZUFBQUMsSUFD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TUFBTyxDQUNwQ0MsRUFBU0YsRUFBVSxFQUNuQkksRUFBUyxFQUVUQyxFQUFTLEVBRWIsSUFBS1MsRUFIRFgsRUFBU0osRUFHTWUsRUFBTVQsRUFBUVMsR0FBTyxFQUFHLENBQ3ZDLElBQUs1QixFQUFNZ0IsRUFBUWhCLEVBQU1rQixJQUNyQlMsRUFBYTNCLEVBQU1pQixFQUFTLEVBQUlXLEVBYWpCLFVBWGZHLEVBQVVELEVBQVNHLE1BQU1wRCxNQUNyQm1CLEVBQ0E0QixHQUVJTSxJQUFLQyxFQUFrQlIsRUFBYSxHQUNwQ1MsTUFBT0QsRUFBa0JSLEVBQWEsR0FDdENVLEtBQU1GLEVBQWtCUixFQUFhLEdBQ3JDbkIsTUFBTzJCLEVBQWtCUixRQVZKM0IsS0FtQmpDLEdBQWUsU0FBWCtCLEVBQ0EsT0FLWixTQUFBSSxFQUEyQkcsR0FDdkIsT0FBTyxTQUFTQyxHQUNaLElBQUtBLEVBQ0QsT0FBT25CLEVBQU9rQixHQUdsQmxCLEVBQU9rQixHQUFPQyxHQUl0QixPQUFPcEYsR0FFZndCLEVBamNBIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtdLCBmYWN0b3J5KTtcblx0ZWxzZSB7XG5cdFx0dmFyIGEgPSBmYWN0b3J5KCk7XG5cdFx0Zm9yKHZhciBpIGluIGEpICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgPyBleHBvcnRzIDogcm9vdClbaV0gPSBhW2ldO1xuXHR9XG59KSh3aW5kb3csIGZ1bmN0aW9uKCkge1xucmV0dXJuICIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJleHBvcnQgZW51bSBUeXBlUmVhZGVyIHtcbiAgICBUT1AgPSAnVE9QJyxcbiAgICBSSUdIVCA9ICdSSUdIVCcsXG4gICAgQk9UVE9NID0gJ0JPVFRPTScsXG4gICAgTEVGVCA9ICdMRUZUJ1xufVxuIiwiZXhwb3J0IGFic3RyYWN0IGNsYXNzIENhbnZhc0hlbHBlciB7XG4gICAgLyoqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB3aWR0aFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBoZWlnaHRcbiAgICAgKiBAcmV0dXJucyB7SFRNTENhbnZhc0VsZW1lbnR9XG4gICAgICovXG4gICAgc3RhdGljIGNyZWF0ZSh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcik6IEhUTUxDYW52YXNFbGVtZW50IHtcbiAgICAgICAgbGV0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICAgICAgICBjYW52YXMud2lkdGggPSB3aWR0aDtcbiAgICAgICAgY2FudmFzLmhlaWdodCA9IGhlaWdodDtcblxuICAgICAgICByZXR1cm4gY2FudmFzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gd2lkdGhcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaGVpZ2h0XG4gICAgICogQHJldHVybnMge0NhbnZhc1JlbmRlcmluZ0NvbnRleHQyRH1cbiAgICAgKi9cbiAgICBzdGF0aWMgY29udGV4dCh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcik6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCB7XG4gICAgICAgIHJldHVybiBDYW52YXNIZWxwZXIuY3JlYXRlKHdpZHRoLCBoZWlnaHQpLmdldENvbnRleHQoJzJkJyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ2FudmFzSGVscGVyIH0gZnJvbSAnLi9jYW52YXMuaGVscGVyJztcblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEltYWdlRGF0YUhlbHBlciB7XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIC0gQ29udmllcnRlIHVuIGltYWdlRGF0YSBvYmplY3QgYSB1biBpbWFnZSBvYmplY3RcbiAgICAgKiBAcGFyYW0ge0ltYWdlRGF0YX0gaW1hZ2VEYXRhIC0gT2JqZXRvIGNvbiBtYXRyaXogZGUgZGF0b3MgZGUgbGEgaW1hZ2VuXG4gICAgICogQHJldHVybiB7SFRNTEltYWdlRWxlbWVudH1cbiAgICAgKi9cbiAgICBzdGF0aWMgZ2V0SW1hZ2UoaW1hZ2VEYXRhKSB7XG4gICAgICAgIEltYWdlRGF0YUhlbHBlci52YWxpZGF0ZShpbWFnZURhdGEpO1xuXG4gICAgICAgIGxldCBpbWdXaWR0aCA9IGltYWdlRGF0YS53aWR0aDtcbiAgICAgICAgbGV0IGltZ0hlaWdodCA9IGltYWdlRGF0YS5oZWlnaHQ7XG5cbiAgICAgICAgbGV0IGNhbnZhcyA9IENhbnZhc0hlbHBlci5jcmVhdGUoaW1nV2lkdGgsIGltZ0hlaWdodCk7XG4gICAgICAgIGxldCBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG5cbiAgICAgICAgY29udGV4dC5wdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCAwLCAwKTtcblxuICAgICAgICBsZXQgaW1hZ2UgPSBuZXcgSW1hZ2UoKTtcbiAgICAgICAgaW1hZ2Uud2lkdGggPSBpbWdXaWR0aDtcbiAgICAgICAgaW1hZ2UuaGVpZ2h0ID0gaW1nSGVpZ2h0O1xuXG4gICAgICAgIGltYWdlLnNyYyA9IGNhbnZhcy50b0RhdGFVUkwoJ2ltYWdlL3BuZycpO1xuXG4gICAgICAgIHJldHVybiBpbWFnZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHBhcmFtIHtIVE1MSW1hZ2VFbGVtZW50fSBpbWFnZVxuICAgICAqIEByZXR1cm5zIHtJbWFnZURhdGF9XG4gICAgICovXG4gICAgc3RhdGljIGdldEltYWdlRGF0YShpbWFnZTogSFRNTEltYWdlRWxlbWVudCk6IEltYWdlRGF0YSB7XG4gICAgICAgIGxldCBpbWdXaWR0aCA9IGltYWdlLndpZHRoO1xuICAgICAgICBsZXQgaW1nSGVpZ2h0ID0gaW1hZ2UuaGVpZ2h0O1xuXG4gICAgICAgIGxldCBjb250ZXh0ID0gQ2FudmFzSGVscGVyLmNvbnRleHQoaW1nV2lkdGgsIGltZ0hlaWdodCk7XG4gICAgICAgIGNvbnRleHQuZHJhd0ltYWdlKGltYWdlLCAwLCAwLCBpbWdXaWR0aCwgaW1nSGVpZ2h0KTtcblxuICAgICAgICByZXR1cm4gY29udGV4dC5nZXRJbWFnZURhdGEoMCwgMCwgaW1nV2lkdGgsIGltZ0hlaWdodCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB3aWR0aFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBoZWlnaHRcbiAgICAgKiBAcmV0dXJucyB7SW1hZ2VEYXRhfVxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVhdGUod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpOiBJbWFnZURhdGEge1xuICAgICAgICByZXR1cm4gQ2FudmFzSGVscGVyLmNvbnRleHQod2lkdGgsIGhlaWdodCkuY3JlYXRlSW1hZ2VEYXRhKFxuICAgICAgICAgICAgd2lkdGgsXG4gICAgICAgICAgICBoZWlnaHRcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHBhcmFtIHtJbWFnZURhdGF9IGltYWdlRGF0YSBcbiAgICAgKi9cbiAgICBzdGF0aWMgdmFsaWRhdGUoaW1hZ2VEYXRhOiBJbWFnZURhdGEpIHtcbiAgICAgICAgaWYgKGlzKGltYWdlRGF0YSkgIT09ICdpbWFnZWRhdGEnKSB7XG4gICAgICAgICAgICB0aHJvdyAnSW1hZ2VEYXRhIEV4Y2VwdGlvbjogTm8gZXMgY29tcGF0aWJsZSBlbCB0aXBvIGRlIGRhdG8nO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiBpcyhlbGVtZW50KSB7XG4gICAgcmV0dXJuIHt9LnRvU3RyaW5nXG4gICAgICAgIC5jYWxsKGVsZW1lbnQpXG4gICAgICAgIC5tYXRjaCgvXFxzKFthLXp8QS1aXSspLylbMV1cbiAgICAgICAgLnRvTG93ZXJDYXNlKCk7XG59XG4iLCJleHBvcnQgYWJzdHJhY3QgY2xhc3MgSW1hZ2VIZWxwZXIge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzcmNcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxIVE1MSW1hZ2VFbGVtZW50Pn1cbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlYXRlKHNyYzogc3RyaW5nKTogUHJvbWlzZTxIVE1MSW1hZ2VFbGVtZW50PiB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICBsZXQgaW1nID0gbmV3IEltYWdlKCk7XG4gICAgICAgICAgICBpbWcub25sb2FkID0gKCkgPT4gcmVzb2x2ZShpbWcpO1xuICAgICAgICAgICAgaW1nLm9uZXJyb3IgPSByZWplY3Q7XG4gICAgICAgICAgICBpbWcuc3JjID0gc3JjO1xuICAgICAgICB9KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBUeXBlUmVhZGVyIH0gZnJvbSAnLi9jb25zdGFudHMvdHlwZS1yZWFkZXInO1xuaW1wb3J0IHsgQ29sb3JSR0JBIH0gZnJvbSAnLi9jb250cmFjdHMvY29sb3ItcmdiYSc7XG5pbXBvcnQgeyBJbWFnZURhdGFIZWxwZXIgfSBmcm9tICcuL2hlbHBlcnMvaW1hZ2UtZGF0YS5oZWxwZXInO1xuaW1wb3J0IHsgSW1hZ2VIZWxwZXIgfSBmcm9tICcuL2hlbHBlcnMvaW1hZ2UuaGVscGVyJztcblxuLyoqXG4gKiBAZXhwb3J0XG4gKiBAY2xhc3MgVHJpbUltYWdlXG4gKi9cbmV4cG9ydCBjbGFzcyBUcmltSW1hZ2Uge1xuICAgIHByaXZhdGUgaW1hZ2U6IEhUTUxJbWFnZUVsZW1lbnQ7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIFRyaW1JbWFnZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7SFRNTEltYWdlRWxlbWVudH0gaW1hZ2UgSW1hZ2VuIGEgcHJvY2VzYXJcbiAgICAgKiBAcGFyYW0ge2FueX0gZnVuY0xvYWRCYWNrIEZ1bmNpw7NuIGJhY2sgcGFyYSBlbCBsb2FkIGRlIGxhIGltYWdlblxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGltYWdlOiBIVE1MSW1hZ2VFbGVtZW50LCBmdW5jTG9hZEJhY2spIHtcbiAgICAgICAgdGhpcy5jb25maWd1cmVJbWFnZShpbWFnZSwgZnVuY0xvYWRCYWNrKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAZGVzY3JpcHRpb24gLSBDb25maWd1cmEgZWwgcGFyYW1ldHJvIGRlIGVudHJhZGEgXCJpbWFnZVwiIGRlbCBjb25zdHJ1Y3RvclxuICAgICAqXG4gICAgICogQHBhcmFtIHtbaW1hZ2Ugb2JqZWN0LCBTdHJpbmddfSBpbWFnZSAtIEltYWdlbiBhIHRyYXRhclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIC0gRnVuY2lvbiBjYWxsYmFja1xuICAgICAqXG4gICAgICogQHJldHVybiB7aW1hZ2VEYXRhIG9iamVjdH1cbiAgICAgKi9cbiAgICBhc3luYyBjb25maWd1cmVJbWFnZShpbWFnZTogc3RyaW5nIHwgSFRNTEltYWdlRWxlbWVudCwgY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5pbWFnZSA9XG4gICAgICAgICAgICB0eXBlb2YgaW1hZ2UgPT09ICdzdHJpbmcnXG4gICAgICAgICAgICAgICAgPyBhd2FpdCBJbWFnZUhlbHBlci5jcmVhdGUoaW1hZ2UpXG4gICAgICAgICAgICAgICAgOiA8SFRNTEltYWdlRWxlbWVudD5pbWFnZTtcblxuICAgICAgICBpZiAoY2FsbGJhY2sgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY2FsbGJhY2suY2FsbCh0aGlzLCB0aGlzLmltYWdlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcGFyYW0ge2FueX0gW2ltYWdlXVxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IFtjYWxsYmFja11cbiAgICAgKiBAcmV0dXJuc1xuICAgICAqL1xuICAgIHN0YXRpYyB0cmltKGltYWdlPywgY2FsbGJhY2s/KSB7XG4gICAgICAgIHJldHVybiBuZXcgVHJpbUltYWdlKGltYWdlLCBjYWxsYmFjaykudHJpbSgpO1xuICAgIH1cblxuICAgIHN0YXRpYyB0cmltVG9wKGltYWdlPywgY2FsbGJhY2s/KSB7XG4gICAgICAgIHJldHVybiBuZXcgVHJpbUltYWdlKGltYWdlLCBjYWxsYmFjaykudHJpbVRvcCgpO1xuICAgIH1cblxuICAgIHN0YXRpYyB0cmltQm90dG9tKGltYWdlPywgY2FsbGJhY2s/KSB7XG4gICAgICAgIHJldHVybiBuZXcgVHJpbUltYWdlKGltYWdlLCBjYWxsYmFjaykudHJpbUJvdHRvbSgpO1xuICAgIH1cblxuICAgIHN0YXRpYyB0cmltTGVmdChpbWFnZT8sIGNhbGxiYWNrPykge1xuICAgICAgICByZXR1cm4gbmV3IFRyaW1JbWFnZShpbWFnZSwgY2FsbGJhY2spLnRyaW1MZWZ0KCk7XG4gICAgfVxuXG4gICAgc3RhdGljIHRyaW1SaWdodChpbWFnZT8sIGNhbGxiYWNrPykge1xuICAgICAgICByZXR1cm4gbmV3IFRyaW1JbWFnZShpbWFnZSwgY2FsbGJhY2spLnRyaW1SaWdodCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBkZXNjcmlwdGlvbiAtIEVsaW1pbmEgcGl4ZWxlcyBpbm5lY2VzYXJpb3MgcGFyYSB0b2RvcyBsb3MgYm9yZGVzIGRlIGxhIGltYWdlblxuICAgICAqL1xuICAgIHRyaW0oKSB7XG4gICAgICAgIHRoaXMuaW1hZ2UgPSBJbWFnZURhdGFIZWxwZXIuZ2V0SW1hZ2UoXG4gICAgICAgICAgICB0aGlzLl90cmltKEltYWdlRGF0YUhlbHBlci5nZXRJbWFnZURhdGEodGhpcy5pbWFnZSkpXG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIC0gRWxpbWluYSBwaXhlbGVzIGlubmVjZXNhcmlvcyBwYXJhIGVsIGJvcmRlIHN1cGVyaW9yIGRlIGxhIGltYWdlblxuICAgICAqIEBwYXJhbSBbaW1hZ2Ugb2JqZWN0XSBpbWFnZSAtIFBhcmFtZXRybyBvcGNpb25hbCB0aXBvIEltYWdlXG4gICAgICogQHJldHVybiBbaW1hZ2Ugb2JqZWN0LCB0aGlzXSAtIFJldG9ybmEgdGhpcyBzaSBlbCBwYXJhbWV0cm8gZXMgaW5kZWZpbmlkb1xuICAgICAqL1xuICAgIHRyaW1Ub3AoKSB7XG4gICAgICAgIHRoaXMuaW1hZ2UgPSBJbWFnZURhdGFIZWxwZXIuZ2V0SW1hZ2UoXG4gICAgICAgICAgICB0aGlzLl90cmltVG9wKEltYWdlRGF0YUhlbHBlci5nZXRJbWFnZURhdGEodGhpcy5pbWFnZSkpXG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIC0gRWxpbWluYSBwaXhlbGVzIGlubmVjZXNhcmlvcyBwYXJhIGVsIGJvcmRlIGluZmVyaW9yIGRlIGxhIGltYWdlblxuICAgICAqIEBwYXJhbSBbaW1hZ2Ugb2JqZWN0XSBpbWFnZSAtIFBhcmFtZXRybyBvcGNpb25hbCB0aXBvIEltYWdlXG4gICAgICogQHJldHVybiBbaW1hZ2Ugb2JqZWN0LCB0aGlzXSAtIFJldG9ybmEgdGhpcyBzaSBlbCBwYXJhbWV0cm8gZXMgaW5kZWZpbmlkb1xuICAgICAqL1xuICAgIHRyaW1Cb3R0b20oKSB7XG4gICAgICAgIHRoaXMuaW1hZ2UgPSBJbWFnZURhdGFIZWxwZXIuZ2V0SW1hZ2UoXG4gICAgICAgICAgICB0aGlzLl90cmltQm90dG9tKEltYWdlRGF0YUhlbHBlci5nZXRJbWFnZURhdGEodGhpcy5pbWFnZSkpXG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIC0gRWxpbWluYSBwaXhlbGVzIGlubmVjZXNhcmlvcyBwYXJhIGVsIGJvcmRlIGl6cXVpZXJkbyBkZSBsYSBpbWFnZW5cbiAgICAgKiBAcGFyYW0gW2ltYWdlIG9iamVjdF0gaW1hZ2UgLSBQYXJhbWV0cm8gb3BjaW9uYWwgdGlwbyBJbWFnZVxuICAgICAqIEByZXR1cm4gW2ltYWdlIG9iamVjdCwgdGhpc10gLSBSZXRvcm5hIHRoaXMgc2kgZWwgcGFyYW1ldHJvIGVzIGluZGVmaW5pZG9cbiAgICAgKi9cbiAgICB0cmltTGVmdCgpIHtcbiAgICAgICAgdGhpcy5pbWFnZSA9IEltYWdlRGF0YUhlbHBlci5nZXRJbWFnZShcbiAgICAgICAgICAgIHRoaXMuX3RyaW1MZWZ0KEltYWdlRGF0YUhlbHBlci5nZXRJbWFnZURhdGEodGhpcy5pbWFnZSkpXG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIC0gRWxpbWluYSBwaXhlbGVzIGlubmVjZXNhcmlvcyBwYXJhIGVsIGJvcmRlIGRlcmVjaG8gZGUgbGEgaW1hZ2VuXG4gICAgICogQHJldHVybnMge3RoaXN9XG4gICAgICovXG4gICAgdHJpbVJpZ2h0KCk6IHRoaXMge1xuICAgICAgICB0aGlzLmltYWdlID0gSW1hZ2VEYXRhSGVscGVyLmdldEltYWdlKFxuICAgICAgICAgICAgdGhpcy5fdHJpbVJpZ2h0KEltYWdlRGF0YUhlbHBlci5nZXRJbWFnZURhdGEodGhpcy5pbWFnZSkpXG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIC0gRWxpbWluYSBwaXhlbGVzIGRlIGxhIGltYWdlbiBpbm5lY2VzYXJpb3NcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7SW1hZ2VEYXRhfSBpbWFnZURhdGFcbiAgICAgKiBAcmV0dXJucyB7SW1hZ2VEYXRhfVxuICAgICAqL1xuICAgIHByaXZhdGUgX3RyaW0oaW1hZ2VEYXRhOiBJbWFnZURhdGEpOiBJbWFnZURhdGEge1xuICAgICAgICBJbWFnZURhdGFIZWxwZXIudmFsaWRhdGUoaW1hZ2VEYXRhKTtcblxuICAgICAgICBsZXQgdHJpbW1lZEltYWdlID0gdGhpcy5fdHJpbVRvcChpbWFnZURhdGEpO1xuICAgICAgICB0cmltbWVkSW1hZ2UgPSB0aGlzLl90cmltQm90dG9tKHRyaW1tZWRJbWFnZSk7XG4gICAgICAgIHRyaW1tZWRJbWFnZSA9IHRoaXMuX3RyaW1MZWZ0KHRyaW1tZWRJbWFnZSk7XG4gICAgICAgIHRyaW1tZWRJbWFnZSA9IHRoaXMuX3RyaW1SaWdodCh0cmltbWVkSW1hZ2UpO1xuXG4gICAgICAgIHJldHVybiB0cmltbWVkSW1hZ2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0ltYWdlRGF0YX0gaW1hZ2VEYXRhXG4gICAgICogQHJldHVybnMge0ltYWdlRGF0YX1cbiAgICAgKi9cbiAgICBwcml2YXRlIF90cmltVG9wKGltYWdlRGF0YTogSW1hZ2VEYXRhKTogSW1hZ2VEYXRhIHtcbiAgICAgICAgbGV0IHJvdyA9IDA7XG4gICAgICAgIGxldCBsZW5naHRDb2wgPSBpbWFnZURhdGEud2lkdGggKiA0O1xuICAgICAgICBsZXQgbGVuZ2h0Um93ID0gaW1hZ2VEYXRhLmhlaWdodDtcblxuICAgICAgICB0aGlzLnJlYWRJbWFnZURhdGEoXG4gICAgICAgICAgICBUeXBlUmVhZGVyLlRPUCxcbiAgICAgICAgICAgIGltYWdlRGF0YSxcbiAgICAgICAgICAgIChfcm93LCBfY29sLCByZ2JhOiBDb2xvclJHQkEpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAocmdiYS5hbHBoYSgpICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcm93ID0gX3JvdztcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ2JyZWFrJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuY3V0SW1hZ2VEYXRhKGltYWdlRGF0YSwgcm93LCAwLCBsZW5naHRSb3csIGxlbmdodENvbCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0ltYWdlRGF0YX0gaW1hZ2VEYXRhXG4gICAgICogQHJldHVybnMge0ltYWdlRGF0YX1cbiAgICAgKi9cbiAgICBwcml2YXRlIF90cmltQm90dG9tKGltYWdlRGF0YTogSW1hZ2VEYXRhKTogSW1hZ2VEYXRhIHtcbiAgICAgICAgbGV0IGxlbmdodFJvdyA9IGltYWdlRGF0YS5oZWlnaHQ7XG4gICAgICAgIGxldCBsZW5naHRDb2wgPSBpbWFnZURhdGEud2lkdGggKiA0O1xuXG4gICAgICAgIHRoaXMucmVhZEltYWdlRGF0YShcbiAgICAgICAgICAgIFR5cGVSZWFkZXIuQk9UVE9NLFxuICAgICAgICAgICAgaW1hZ2VEYXRhLFxuICAgICAgICAgICAgKF9yb3csIF9jb2wsIHJnYmE6IENvbG9yUkdCQSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChyZ2JhLmFscGhhKCkgIT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBsZW5naHRSb3cgPSBfcm93O1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnYnJlYWsnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcblxuICAgICAgICByZXR1cm4gdGhpcy5jdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCAwLCAwLCBsZW5naHRSb3csIGxlbmdodENvbCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0ltYWdlRGF0YX0gaW1hZ2VEYXRhXG4gICAgICogQHJldHVybnMge0ltYWdlRGF0YX1cbiAgICAgKi9cbiAgICBwcml2YXRlIF90cmltTGVmdChpbWFnZURhdGE6IEltYWdlRGF0YSk6IEltYWdlRGF0YSB7XG4gICAgICAgIGxldCBjb2x1bW4gPSAwO1xuICAgICAgICBsZXQgbGVuZ2h0Q29sID0gaW1hZ2VEYXRhLndpZHRoICogNDtcbiAgICAgICAgbGV0IGxlbmdodFJvdyA9IGltYWdlRGF0YS5oZWlnaHQ7XG5cbiAgICAgICAgdGhpcy5yZWFkSW1hZ2VEYXRhKFxuICAgICAgICAgICAgVHlwZVJlYWRlci5MRUZULFxuICAgICAgICAgICAgaW1hZ2VEYXRhLFxuICAgICAgICAgICAgKF9yb3csIF9jb2wsIHJnYmE6IENvbG9yUkdCQSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChyZ2JhLmFscGhhKCkgIT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW4gPSBfY29sO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnYnJlYWsnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcblxuICAgICAgICByZXR1cm4gdGhpcy5jdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCAwLCBjb2x1bW4sIGxlbmdodFJvdywgbGVuZ2h0Q29sKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7SW1hZ2VEYXRhfSBpbWFnZURhdGFcbiAgICAgKiBAcmV0dXJucyB7SW1hZ2VEYXRhfVxuICAgICAqL1xuICAgIHByaXZhdGUgX3RyaW1SaWdodChpbWFnZURhdGE6IEltYWdlRGF0YSk6IEltYWdlRGF0YSB7XG4gICAgICAgIGxldCBsZW5fY29sID0gaW1hZ2VEYXRhLndpZHRoICogNDtcbiAgICAgICAgbGV0IGxlbl9yb3cgPSBpbWFnZURhdGEuaGVpZ2h0O1xuXG4gICAgICAgIHRoaXMucmVhZEltYWdlRGF0YShcbiAgICAgICAgICAgIFR5cGVSZWFkZXIuUklHSFQsXG4gICAgICAgICAgICBpbWFnZURhdGEsXG4gICAgICAgICAgICAoX3JvdywgX2NvbCwgcmdiYTogQ29sb3JSR0JBKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHJnYmEuYWxwaGEoKSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGxlbl9jb2wgPSBfY29sO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnYnJlYWsnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcblxuICAgICAgICByZXR1cm4gdGhpcy5jdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCAwLCAwLCBsZW5fcm93LCBsZW5fY29sKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge0ltYWdlRGF0YX0gaW1hZ2VEYXRhXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHJvd0luaVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjb2xJbmlcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcm93RmluXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGNvbEZpblxuICAgICAqIEByZXR1cm5zIHtJbWFnZURhdGF9XG4gICAgICovXG4gICAgY3V0SW1hZ2VEYXRhKFxuICAgICAgICBpbWFnZURhdGE6IEltYWdlRGF0YSxcbiAgICAgICAgcm93SW5pOiBudW1iZXIsXG4gICAgICAgIGNvbEluaTogbnVtYmVyLFxuICAgICAgICByb3dGaW46IG51bWJlcixcbiAgICAgICAgY29sRmluOiBudW1iZXJcbiAgICApOiBJbWFnZURhdGEge1xuICAgICAgICBJbWFnZURhdGFIZWxwZXIudmFsaWRhdGUoaW1hZ2VEYXRhKTtcblxuICAgICAgICBsZXQgcGl4ZWxzID0gaW1hZ2VEYXRhLmRhdGE7XG4gICAgICAgIGxldCBsZW5fY29sID0gaW1hZ2VEYXRhLndpZHRoICogNDtcblxuICAgICAgICByb3dGaW4gPSByb3dGaW4gPT0gMCA/IDEgOiByb3dGaW47XG4gICAgICAgIGNvbEZpbiA9IGNvbEZpbiA9PSAwID8gMSA6IGNvbEZpbjtcblxuICAgICAgICBsZXQgY29weUhlaWdodCA9IHJvd0ZpbiA9PSByb3dJbmkgPyAxIDogcm93RmluIC0gcm93SW5pLFxuICAgICAgICAgICAgY29weVdpZHRoID0gY29sRmluIC8gNCAtIGNvbEluaSAvIDQ7XG5cbiAgICAgICAgbGV0IGNvcHlJbWFnZURhdGE6IEltYWdlRGF0YSA9IEltYWdlRGF0YUhlbHBlci5jcmVhdGUoXG4gICAgICAgICAgICBjb3B5V2lkdGgsXG4gICAgICAgICAgICBjb3B5SGVpZ2h0XG4gICAgICAgICk7XG5cbiAgICAgICAgbGV0IGRpZmZDb2wgPSBsZW5fY29sIC0gY29sRmluO1xuICAgICAgICBsZXQgY291bnRDb3B5ID0gMDtcblxuICAgICAgICBmb3IgKGxldCByb3cgPSByb3dJbmk7IHJvdyA8IHJvd0Zpbjsgcm93KyspIHtcbiAgICAgICAgICAgIGxldCByb3dDdXJyZW50ID0gcm93ICogY29sRmluICsgcm93ICogZGlmZkNvbDtcblxuICAgICAgICAgICAgZm9yIChsZXQgY29sID0gY29sSW5pOyBjb2wgPCBjb2xGaW47IGNvbCArPSA0LCBjb3VudENvcHkgKz0gNCkge1xuICAgICAgICAgICAgICAgIGNvcHlJbWFnZURhdGEuZGF0YVtjb3VudENvcHldID0gcGl4ZWxzW3Jvd0N1cnJlbnQgKyBjb2xdO1xuICAgICAgICAgICAgICAgIGNvcHlJbWFnZURhdGEuZGF0YVtjb3VudENvcHkgKyAxXSA9XG4gICAgICAgICAgICAgICAgICAgIHBpeGVsc1tyb3dDdXJyZW50ICsgY29sICsgMV07XG4gICAgICAgICAgICAgICAgY29weUltYWdlRGF0YS5kYXRhW2NvdW50Q29weSArIDJdID1cbiAgICAgICAgICAgICAgICAgICAgcGl4ZWxzW3Jvd0N1cnJlbnQgKyBjb2wgKyAyXTtcbiAgICAgICAgICAgICAgICBjb3B5SW1hZ2VEYXRhLmRhdGFbY291bnRDb3B5ICsgM10gPVxuICAgICAgICAgICAgICAgICAgICBwaXhlbHNbcm93Q3VycmVudCArIGNvbCArIDNdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNvcHlJbWFnZURhdGE7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge1R5cGVSZWFkZXJ9IHR5cGVSZWFkZXJcbiAgICAgKiBAcGFyYW0ge0ltYWdlRGF0YX0gaW1hZ2VEYXRhXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gZnVuY0JhY2tcbiAgICAgKiBAcmV0dXJucyB7SW1hZ2VEYXRhfVxuICAgICAqL1xuICAgIHByaXZhdGUgcmVhZEltYWdlRGF0YShcbiAgICAgICAgdHlwZVJlYWRlcjogVHlwZVJlYWRlcixcbiAgICAgICAgaW1hZ2VEYXRhOiBJbWFnZURhdGEsXG4gICAgICAgIGZ1bmNCYWNrXG4gICAgKTogSW1hZ2VEYXRhIHtcbiAgICAgICAgSW1hZ2VEYXRhSGVscGVyLnZhbGlkYXRlKGltYWdlRGF0YSk7XG5cbiAgICAgICAgbGV0IHBpeGVscyA9IGltYWdlRGF0YS5kYXRhO1xuICAgICAgICBsZXQgcm93O1xuICAgICAgICBsZXQgY29sO1xuICAgICAgICBsZXQgcm93Q3VycmVudCA9IC0xO1xuXG4gICAgICAgIGxldCBsZW5fY29sID0gaW1hZ2VEYXRhLndpZHRoICogNDtcbiAgICAgICAgbGV0IGxlbl9yb3cgPSBpbWFnZURhdGEuaGVpZ2h0O1xuXG4gICAgICAgIGxldCBpc0JyZWFrOiBhbnkgPSBmYWxzZTtcblxuICAgICAgICBpZiAodHlwZVJlYWRlciA9PT0gVHlwZVJlYWRlci5UT1ApIHtcbiAgICAgICAgICAgIGxldCByb3dJbmkgPSAwO1xuICAgICAgICAgICAgbGV0IHJvd0ZpbiA9IGxlbl9yb3c7XG4gICAgICAgICAgICBsZXQgY29sSW5pID0gMDtcbiAgICAgICAgICAgIGxldCBjb2xGaW4gPSBsZW5fY29sO1xuXG4gICAgICAgICAgICBsZXQgaW50ZXJhdG9yID0ge1xuICAgICAgICAgICAgICAgIHJvdzogMSxcbiAgICAgICAgICAgICAgICBjb2w6IDRcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGZvciAocm93ID0gcm93SW5pOyByb3cgPCByb3dGaW47IHJvdyArPSBpbnRlcmF0b3Iucm93KSB7XG4gICAgICAgICAgICAgICAgcm93Q3VycmVudCA9IHJvdyAqIGxlbl9jb2w7XG5cbiAgICAgICAgICAgICAgICBmb3IgKGNvbCA9IGNvbEluaTsgY29sIDwgY29sRmluOyBjb2wgKz0gaW50ZXJhdG9yLmNvbCkge1xuICAgICAgICAgICAgICAgICAgICBpc0JyZWFrID0gZnVuY0JhY2suYXBwbHkodGhpcywgW1xuICAgICAgICAgICAgICAgICAgICAgICAgcm93LFxuICAgICAgICAgICAgICAgICAgICAgICAgY29sLFxuICAgICAgICAgICAgICAgICAgICAgICAgPENvbG9yUkdCQT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVkOiBnZXRBbmRTZXRGb3JQaXhlbChyb3dDdXJyZW50ICsgY29sKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncmVlbjogZ2V0QW5kU2V0Rm9yUGl4ZWwocm93Q3VycmVudCArIGNvbCArIDEpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsdWU6IGdldEFuZFNldEZvclBpeGVsKHJvd0N1cnJlbnQgKyBjb2wgKyAyKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHBoYTogZ2V0QW5kU2V0Rm9yUGl4ZWwocm93Q3VycmVudCArIGNvbCArIDMpXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIF0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0JyZWFrID09ICdicmVhaycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGlzQnJlYWsgPT0gJ2JyZWFrJykge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZVJlYWRlciA9PT0gVHlwZVJlYWRlci5CT1RUT00pIHtcbiAgICAgICAgICAgIGxldCByb3dJbmkgPSBsZW5fcm93O1xuICAgICAgICAgICAgbGV0IHJvd0ZpbiA9IDA7XG4gICAgICAgICAgICBsZXQgY29sSW5pID0gbGVuX2NvbDtcbiAgICAgICAgICAgIGxldCBjb2xGaW4gPSAwO1xuXG4gICAgICAgICAgICBmb3IgKHJvdyA9IHJvd0luaTsgcm93ID49IHJvd0Zpbjsgcm93LS0pIHtcbiAgICAgICAgICAgICAgICByb3dDdXJyZW50ID0gcm93ICogY29sSW5pO1xuXG4gICAgICAgICAgICAgICAgZm9yIChjb2wgPSBjb2xJbmk7IGNvbCA+IGNvbEZpbjsgY29sIC09IDQpIHtcbiAgICAgICAgICAgICAgICAgICAgaXNCcmVhayA9IGZ1bmNCYWNrLmFwcGx5KHRoaXMsIFtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxDb2xvclJHQkE+e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZDogZ2V0QW5kU2V0Rm9yUGl4ZWwocm93Q3VycmVudCAtIGNvbCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JlZW46IGdldEFuZFNldEZvclBpeGVsKHJvd0N1cnJlbnQgLSBjb2wgLSAzKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibHVlOiBnZXRBbmRTZXRGb3JQaXhlbChyb3dDdXJyZW50IC0gY29sIC0gMiksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGE6IGdldEFuZFNldEZvclBpeGVsKHJvd0N1cnJlbnQgLSBjb2wgLSAxKVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBdKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNCcmVhayA9PSAnYnJlYWsnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChpc0JyZWFrID09ICdicmVhaycpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHR5cGVSZWFkZXIgPT09IFR5cGVSZWFkZXIuTEVGVCkge1xuICAgICAgICAgICAgbGV0IHJvd0luaSA9IDA7XG4gICAgICAgICAgICBsZXQgcm93RmluID0gbGVuX3JvdztcbiAgICAgICAgICAgIGxldCBjb2xJbmkgPSAwO1xuICAgICAgICAgICAgbGV0IGNvbEZpbiA9IGxlbl9jb2w7XG5cbiAgICAgICAgICAgIGZvciAoY29sID0gY29sSW5pOyBjb2wgPCBjb2xGaW47IGNvbCArPSA0KSB7XG4gICAgICAgICAgICAgICAgZm9yIChyb3cgPSByb3dJbmk7IHJvdyA8IHJvd0Zpbjsgcm93KyspIHtcbiAgICAgICAgICAgICAgICAgICAgcm93Q3VycmVudCA9IHJvdyAqIGNvbEZpbjtcblxuICAgICAgICAgICAgICAgICAgICBpc0JyZWFrID0gZnVuY0JhY2suYXBwbHkodGhpcywgW1xuICAgICAgICAgICAgICAgICAgICAgICAgcm93LFxuICAgICAgICAgICAgICAgICAgICAgICAgY29sLFxuICAgICAgICAgICAgICAgICAgICAgICAgPENvbG9yUkdCQT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVkOiBnZXRBbmRTZXRGb3JQaXhlbChyb3dDdXJyZW50ICsgY29sKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncmVlbjogZ2V0QW5kU2V0Rm9yUGl4ZWwocm93Q3VycmVudCArIGNvbCArIDEpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsdWU6IGdldEFuZFNldEZvclBpeGVsKHJvd0N1cnJlbnQgKyBjb2wgKyAyKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHBoYTogZ2V0QW5kU2V0Rm9yUGl4ZWwocm93Q3VycmVudCArIGNvbCArIDMpXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIF0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0JyZWFrID09ICdicmVhaycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGlzQnJlYWsgPT0gJ2JyZWFrJykge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZVJlYWRlciA9PT0gVHlwZVJlYWRlci5SSUdIVCkge1xuICAgICAgICAgICAgbGV0IHJvd0luaSA9IGxlbl9yb3cgLSAxO1xuICAgICAgICAgICAgbGV0IHJvd0ZpbiA9IDE7XG4gICAgICAgICAgICBsZXQgY29sSW5pID0gbGVuX2NvbDtcbiAgICAgICAgICAgIGxldCBjb2xGaW4gPSAwO1xuXG4gICAgICAgICAgICBmb3IgKGNvbCA9IGNvbEluaTsgY29sID4gY29sRmluOyBjb2wgLT0gNCkge1xuICAgICAgICAgICAgICAgIGZvciAocm93ID0gcm93SW5pOyByb3cgPiByb3dGaW47IHJvdy0tKSB7XG4gICAgICAgICAgICAgICAgICAgIHJvd0N1cnJlbnQgPSByb3cgKiBjb2xJbmkgLSA0ICsgY29sO1xuXG4gICAgICAgICAgICAgICAgICAgIGlzQnJlYWsgPSBmdW5jQmFjay5hcHBseSh0aGlzLCBbXG4gICAgICAgICAgICAgICAgICAgICAgICByb3csXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2wsXG4gICAgICAgICAgICAgICAgICAgICAgICA8Q29sb3JSR0JBPntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWQ6IGdldEFuZFNldEZvclBpeGVsKHJvd0N1cnJlbnQgLSAzKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncmVlbjogZ2V0QW5kU2V0Rm9yUGl4ZWwocm93Q3VycmVudCAtIDIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsdWU6IGdldEFuZFNldEZvclBpeGVsKHJvd0N1cnJlbnQgLSAxKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHBoYTogZ2V0QW5kU2V0Rm9yUGl4ZWwocm93Q3VycmVudClcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzQnJlYWsgPT0gJ2JyZWFrJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoaXNCcmVhayA9PSAnYnJlYWsnKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEFuZFNldEZvclBpeGVsKHBvcykge1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHZhbCkge1xuICAgICAgICAgICAgICAgIGlmICghdmFsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwaXhlbHNbcG9zXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBwaXhlbHNbcG9zXSA9IHZhbDtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gaW1hZ2VEYXRhO1xuICAgIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=